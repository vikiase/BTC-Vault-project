<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flask App Test</title>
</head>
<body>
    <h1>Test Flask API</h1>

    <!-- Add User Form -->
    <h2>Add New User</h2>
    <form id="addUserForm">
        <label for="username">Username:</label><br>
        <input type="text" id="username" name="username" required><br>
        <label for="password">Password:</label><br>
        <input type="password" id="password" name="password" required><br>
        <label for="public_key">Public Key:</label><br>
        <input type="text" id="public_key" name="public_key" required><br>
        <label for="private_key">Private Key:</label><br>
        <input type="text" id="private_key" name="private_key" required><br>
        <label for="api_user_id">API User ID:</label><br>
        <input type="number" id="api_user_id" name="api_user_id" required><br>
        <button type="submit">Add User</button>
    </form>
    <pre id="addUserResponse"></pre>

    <!-- Create Strategy Form -->
    <h2>Create Strategy</h2>
    <form id="createStrategyForm">
        <label for="user_id">User ID:</label><br>
        <input type="number" id="user_id" name="user_id" required><br>
        <label for="amount">Amount:</label><br>
        <input type="number" id="amount" name="amount" required><br>
        <label for="frequency">Frequency:</label><br>
        <input type="number" id="frequency" name="frequency" required><br>
        <label for="goal">Goal:</label><br>
        <input type="number" id="goal" name="goal" required><br>
        <button type="submit">Create Strategy</button>
    </form>
    <pre id="createStrategyResponse"></pre>

    <!-- Add Transactions Form -->
    <h2>Add DCA Transactions</h2>
    <form id="addTransactionsForm">
        <label for="transaction_user_id">User ID:</label><br>
        <input type="number" id="transaction_user_id" name="user_id" required><br> <!-- Změněno na transaction_user_id -->
        <label for="strategy_id">Strategy ID:</label><br>
        <input type="number" id="strategy_id" name="strategy_id" required><br>
        <button type="submit">Add Transactions</button>
    </form>
    <pre id="addTransactionsResponse"></pre>

    <!-- Get User Info -->
    <h2>Get User Info</h2>
    <form id="getUserForm">
        <label for="get_user_id">User ID:</label><br>
        <input type="number" id="get_user_id" name="get_user_id" required><br>
        <button type="submit">Get User Info</button>
    </form>
    <pre id="getUserResponse"></pre>

    <!-- Get Strategies Info -->
    <h2>Get User Strategies</h2>
    <form id="getStrategiesForm">
        <label for="get_strategies_user_id">User ID:</label><br>
        <input type="number" id="get_strategies_user_id" name="get_strategies_user_id" required><br>
        <button type="submit">Get Strategies</button>
    </form>
    <pre id="getStrategiesResponse"></pre>

    <script>
        // Add User Form
        document.getElementById('addUserForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const data = {
                username: document.getElementById('username').value,
                password: document.getElementById('password').value,
                public_key: document.getElementById('public_key').value,
                private_key: document.getElementById('private_key').value,
                api_user_id: document.getElementById('api_user_id').value
            };
            fetch('/add_user', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            })
            .then(response => response.json())
            .then(data => document.getElementById('addUserResponse').textContent = JSON.stringify(data, null, 2))
            .catch(error => console.error('Error:', error));
        });

        // Create Strategy Form
        document.getElementById('createStrategyForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const data = {
                user_id: document.getElementById('user_id').value,
                amount: document.getElementById('amount').value,
                frequency: document.getElementById('frequency').value,
                goal: document.getElementById('goal').value
            };
            fetch('/create_strategy', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            })
            .then(response => response.json())
            .then(data => document.getElementById('createStrategyResponse').textContent = JSON.stringify(data, null, 2))
            .catch(error => console.error('Error:', error));
        });

        // Add DCA Transactions Form
        document.getElementById('addTransactionsForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const data = {
                user_id: document.getElementById('transaction_user_id').value,
                strategy_id: document.getElementById('strategy_id').value
            };
            fetch('/add_transactions', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            })
            .then(response => response.json())
            .then(data => document.getElementById('addTransactionsResponse').textContent = JSON.stringify(data, null, 2))
            .catch(error => console.error('Error:', error));
        });

        // Get User Info Form
        document.getElementById('getUserForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const userId = document.getElementById('get_user_id').value;
            fetch(`/get_user/${userId}`, {
                method: 'GET'
            })
            .then(response => response.json())
            .then(data => document.getElementById('getUserResponse').textContent = JSON.stringify(data, null, 2))
            .catch(error => console.error('Error:', error));
        });

        // Get Strategies Info Form
        document.getElementById('getStrategiesForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const userId = document.getElementById('get_strategies_user_id').value;
            fetch(`/get_strategies/${userId}`, {
                method: 'GET'
            })
            .then(response => response.json())
            .then(data => document.getElementById('getStrategiesResponse').textContent = JSON.stringify(data, null, 2))
            .catch(error => console.error('Error:', error));
        });
    </script>
</body>
</html>
